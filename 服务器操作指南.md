# æœåŠ¡å™¨æ“ä½œæŒ‡å—

## ğŸ“ é¡¹ç›®ä½ç½®
```
/root/kehuxinxi-backend
```

## ğŸ”§ æœåŠ¡å™¨ç«¯æ“ä½œæ­¥éª¤

### 1. è¿æ¥åˆ°æœåŠ¡å™¨
```bash
ssh root@47.113.177.228
```

### 2. è¿›å…¥é¡¹ç›®ç›®å½•
```bash
cd /root/kehuxinxi-backend
```

### 3. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦åŒæ­¥æˆåŠŸ
```bash
ls -la
```
åº”è¯¥èƒ½çœ‹åˆ°ä»¥ä¸‹æ–‡ä»¶å’Œç›®å½•ï¼š
- `app.js`
- `package.json`
- `config/`
- `controllers/`
- `models/`
- `routes/`
- ç­‰ç­‰...

### 4. æ£€æŸ¥æœåŠ¡çŠ¶æ€
```bash
# æŸ¥çœ‹ PM2 è¿›ç¨‹çŠ¶æ€
pm2 status

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
pm2 logs kehuxinxi-backend

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
pm2 logs kehuxinxi-backend --lines 50
```

### 5. å¦‚æœéœ€è¦é‡å¯æœåŠ¡
```bash
# é‡å¯æœåŠ¡
pm2 restart kehuxinxi-backend

# æˆ–è€…åœæ­¢åé‡æ–°å¯åŠ¨
pm2 stop kehuxinxi-backend
pm2 start app.js --name kehuxinxi-backend
```

### 6. æ£€æŸ¥æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
```bash
# æ£€æŸ¥ç«¯å£æ˜¯å¦ç›‘å¬
netstat -tlnp | grep 3000

# æˆ–è€…ä½¿ç”¨ curl æµ‹è¯•
curl http://localhost:3000
```

### 7. æŸ¥çœ‹é”™è¯¯æ—¥å¿—ï¼ˆå¦‚æœæœ‰é—®é¢˜ï¼‰
```bash
# æŸ¥çœ‹ PM2 é”™è¯¯æ—¥å¿—
pm2 logs kehuxinxi-backend --err

# æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—
journalctl -u pm2-root -f
```

## ğŸš€ å¸¸ç”¨å‘½ä»¤

### æœåŠ¡ç®¡ç†
```bash
# å¯åŠ¨æœåŠ¡
pm2 start app.js --name kehuxinxi-backend

# åœæ­¢æœåŠ¡
pm2 stop kehuxinxi-backend

# é‡å¯æœåŠ¡
pm2 restart kehuxinxi-backend

# åˆ é™¤æœåŠ¡
pm2 delete kehuxinxi-backend

# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡
pm2 list
```

### æ—¥å¿—æŸ¥çœ‹
```bash
# æŸ¥çœ‹å®æ—¶æ—¥å¿—
pm2 logs kehuxinxi-backend -f

# æŸ¥çœ‹æœ€è¿‘ 100 è¡Œæ—¥å¿—
pm2 logs kehuxinxi-backend --lines 100

# æ¸…ç©ºæ—¥å¿—
pm2 flush kehuxinxi-backend
```

### æ€§èƒ½ç›‘æ§
```bash
# æŸ¥çœ‹èµ„æºä½¿ç”¨æƒ…å†µ
pm2 monit

# æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯
pm2 show kehuxinxi-backend
```

## ğŸ” æ•…éšœæ’æŸ¥

### å¦‚æœæœåŠ¡æ— æ³•å¯åŠ¨
1. æ£€æŸ¥ä¾èµ–æ˜¯å¦å®‰è£…ï¼š
   ```bash
   npm install --production
   ```

2. æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨ï¼š
   ```bash
   netstat -tlnp | grep 3000
   ```

3. æ£€æŸ¥æ–‡ä»¶æƒé™ï¼š
   ```bash
   ls -la
   chmod +x app.js
   ```

4. æ‰‹åŠ¨å¯åŠ¨æµ‹è¯•ï¼š
   ```bash
   node app.js
   ```

### å¦‚æœè®¿é—®ä¸äº†ç½‘ç«™
1. æ£€æŸ¥é˜²ç«å¢™ï¼š
   ```bash
   ufw status
   ```

2. æ£€æŸ¥ç«¯å£å¼€æ”¾ï¼š
   ```bash
   iptables -L
   ```

3. æ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼š
   ```bash
   systemctl status pm2-root
   ```

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **å¤‡ä»½é‡è¦æ•°æ®**ï¼šåœ¨ä¿®æ”¹å‰å…ˆå¤‡ä»½æ•°æ®åº“å’Œé…ç½®æ–‡ä»¶
2. **æŸ¥çœ‹æ—¥å¿—**ï¼šé‡åˆ°é—®é¢˜æ—¶å…ˆæŸ¥çœ‹æ—¥å¿—æ–‡ä»¶
3. **æƒé™é—®é¢˜**ï¼šç¡®ä¿æ–‡ä»¶æœ‰æ­£ç¡®çš„è¯»å†™æƒé™
4. **ç«¯å£å†²çª**ï¼šç¡®ä¿ 3000 ç«¯å£æ²¡æœ‰è¢«å…¶ä»–æœåŠ¡å ç”¨

## ğŸ†˜ ç´§æ€¥æƒ…å†µ

å¦‚æœæœåŠ¡å®Œå…¨æ— æ³•è®¿é—®ï¼š
```bash
# å¼ºåˆ¶é‡å¯ PM2
pm2 kill
pm2 start app.js --name kehuxinxi-backend

# æˆ–è€…é‡å¯æœåŠ¡å™¨
reboot
```
